% HyungSeok Yoon
% Frequency, Critical Band, Absolute Threshold Lookup table
% ANNEX_D.doc pg.7

function [TABLE, CB_map, AT] = F_CB_AT_table(fs,bitrate)
if nargin ==1
    bitrate = 1;
end

if(fs==32000)
    % index, Frequency Hz, Critical Band Rate z, Absolute Treshold dB
    TABLE = [1	62.50	.617	33.44	
2	125.00	1.232	19.20	
3	187.50	1.842	13.87	
4	250.00	2.445	11.01	
5	312.50	3.037	9.20	
6	375.00	3.618	7.94	
7	437.50	4.185	7.00	
8	500.00	4.736	6.28	
9	562.50	5.272	5.70	
10	625.00	5.789	5.21	
11	687.50	6.289	4.80	
12	750.00	6.770	4.45	
13	812.50	7.233	4.14	
14	875.00	7.677	3.86	
15	937.50	8.103	3.61	
16	1000.00	8.511	3.37	
17	1062.50	8.901	3.15	
18	1125.00	9.275	2.93	
19	1187.50	9.632	2.73	
20	1250.00	9.974	2.53	
21	1312.50	10.301	2.32	
22	1375.00	10.614	2.12	
23	1437.50	10.913	1.92	
24	1500.00	11.199	1.71	
25	1562.50	11.474	1.49	
26	1625.00	11.736	1.27	
27	1687.50	11.988	1.04	
28	1750.00	12.230	.80	
29	1812.50	12.461	.55	
30	1875.00	12.684	.29	
31	1937.50	12.898	.02	
32	2000.00	13.104	-.25	
33	2062.50	13.302	-.54	
34	2125.00	13.493	-.83	
35	2187.50	13.678	-1.12	
36	2250.00	13.855	-1.43	
37	2312.50	14.027	-1.73	
38	2375.00	14.193	-2.04	
39	2437.50	14.354	-2.34	
40	2500.00	14.509	-2.64	
41	2562.50	14.660	-2.93	
42	2625.00	14.807	-3.22	
43	2687.50	14.949	-3.49	
44	2750.00	15.087	-3.74	
45	2812.50	15.221	-3.98	
46	2875.00	15.351	-4.20	
47	2937.50	15.478	-4.40	
48	3000.00	15.602	-4.57	
49	3125.00	15.841	-4.82	
50	3250.00	16.069	-4.96	
51	3375.00	16.287	-4.97	
52	3500.00	16.496	-4.86	
53	3625.00	16.697	-4.63	
54	3750.00	16.891	-4.29	
55	3875.00	17.078	-3.87	
56	4000.00	17.259	-3.39	
57	4125.00	17.434	-2.86	
58	4250.00	17.605	-2.31	
59	4375.00	17.770	-1.77	
60	4500.00	17.932	-1.24	
61	4625.00	18.089	-.74	
62	4750.00	18.242	-.29	
63	4875.00	18.392	.12	
64	5000.00	18.539	.48	
65	5125.00	18.682	.79	
66	5250.00	18.823	1.06	
67	5375.00	18.960	1.29	
68	5500.00	19.095	1.49	
69	5625.00	19.226	1.66	
70	5750.00	19.356	1.81	
71	5875.00	19.482	1.95	
72	6000.00	19.606	2.08	
73	6250.00	19.847	2.33	
74	6500.00	20.079	2.59	
75	6750.00	20.300	2.86	
76	7000.00	20.513	3.17	
77	7250.00	20.717	3.51	
78	7500.00	20.912	3.89	
79	7750.00	21.098	4.31	
80	8000.00	21.275	4.79	
81	8250.00	21.445	5.31	
82	8500.00	21.606	5.88	
83	8750.00	21.760	6.50	
84	9000.00	21.906	7.19	
85	9250.00	22.046	7.93	
86	9500.00	22.178	8.75	
87	9750.00	22.304	9.63	
88	10000.00	22.424	10.58	
89	10250.00	22.538	11.60	
90	10500.00	22.646	12.71	
91	10750.00	22.749	13.90	
92	11000.00	22.847	15.18	
93	11250.00	22.941	16.54	
94	11500.00	23.030	18.01	
95	11750.00	23.114	19.57	
96	12000.00	23.195	21.23	
97	12250.00	23.272	23.01	
98	12500.00	23.345	24.90	
99	12750.00	23.415	26.90	
100	13000.00	23.482	29.03	
101	13250.00	23.546	31.28	
102	13500.00	23.607	33.67	
103	13750.00	23.666	36.19	
104	14000.00	23.722	38.86	
105	14250.00	23.775	41.67	
106	14500.00	23.827	44.63	
107	14750.00	23.876	47.76	
108	15000.00	23.923	51.04	];

elseif fs == 44100
    TABLE = [1	86.13	.850	25.87	
2	172.27	1.694	14.85	
3	258.40	2.525	10.72	
4	344.53	3.337	8.50	
5	430.66	4.124	7.10	
6	516.80	4.882	6.11	
7	602.93	5.608	5.37	
8	689.06	6.301	4.79	
9	775.20	6.959	4.32	
10	861.33	7.581	3.92	
11	947.46	8.169	3.57	
12	1033.59	8.723	3.25	
13	1119.73	9.244	2.95	
14	1205.86	9.734	2.67	
15	1291.99	10.195	2.39	
16	1378.13	10.629	2.11	
17	1464.26	11.037	1.83	
18	1550.39	11.421	1.53	
19	1636.52	11.783	1.23	
20	1722.66	12.125	.90	
21	1808.79	12.448	.56	
22	1894.92	12.753	.21	
23	1981.05	13.042	-.17	
24	2067.19	13.317	-.56	
25	2153.32	13.578	-.96	
26	2239.45	13.826	-1.38	
27	2325.59	14.062	-1.79	
28	2411.72	14.288	-2.21	
29	2497.85	14.504	-2.63	
30	2583.98	14.711	-3.03	
31	2670.12	14.909	-3.41	
32	2756.25	15.100	-3.77	
33	2842.38	15.284	-4.09	
34	2928.52	15.460	-4.37	
35	3014.65	15.631	-4.60	
36	3100.78	15.796	-4.78	
37	3186.91	15.955	-4.91	
38	3273.05	16.110	-4.97	
39	3359.18	16.260	-4.98	
40	3445.31	16.406	-4.92	
41	3531.45	16.547	-4.81	
42	3617.58	16.685	-4.65	
43	3703.71	16.820	-4.43	
44	3789.84	16.951	-4.17	
45	3875.98	17.079	-3.87	
46	3962.11	17.205	-3.54	
47	4048.24	17.327	-3.19	
48	4134.38	17.447	-2.82	
49	4306.64	17.680	-2.06	
50	4478.91	17.905	-1.32	
51	4651.17	18.121	-.64	
52	4823.44	18.331	-.04	
53	4995.70	18.534	.47	
54	5167.97	18.731	.89	
55	5340.23	18.922	1.23	
56	5512.50	19.108	1.51	
57	5684.77	19.289	1.74	
58	5857.03	19.464	1.93	
59	6029.30	19.635	2.11	
60	6201.56	19.801	2.28	
61	6373.83	19.963	2.46	
62	6546.09	20.120	2.63	
63	6718.36	20.273	2.82	
64	6890.63	20.421	3.03	
65	7062.89	20.565	3.25	
66	7235.16	20.705	3.49	
67	7407.42	20.840	3.74	
68	7579.69	20.972	4.02	
69	7751.95	21.099	4.32	
70	7924.22	21.222	4.64	
71	8096.48	21.342	4.98	
72	8268.75	21.457	5.35	
73	8613.28	21.677	6.15	
74	8957.81	21.882	7.07	
75	9302.34	22.074	8.10	
76	9646.88	22.253	9.25	
77	9991.41	22.420	10.54	
78	10335.94	22.576	11.97	
79	10680.47	22.721	13.56	
80	11025.00	22.857	15.31	
81	11369.53	22.984	17.23	
82	11714.06	23.102	19.34	
83	12058.59	23.213	21.64	
84	12403.13	23.317	24.15	
85	12747.66	23.415	26.88	
86	13092.19	23.506	29.84	
87	13436.72	23.592	33.05	
88	13781.25	23.673	36.52	
89	14125.78	23.749	40.25	
90	14470.31	23.821	44.27	
91	14814.84	23.888	48.59	
92	15159.38	23.952	53.22	
93	15503.91	24.013	58.18	
94	15848.44	24.070	63.49	
95	16192.97	24.125	68.00	
96	16537.50	24.176	68.00	
97	16882.03	24.225	68.00	
98	17226.56	24.271	68.00	
99	17571.09	24.316	68.00	
100	17915.63	24.358	68.00	
101	18260.16	24.398	68.00	
102	18604.69	24.436	68.00	
103	18949.22	24.473	68.00	
104	19293.75	24.508	68.00	
105	19638.28	24.542	68.00	
106	19982.81	24.574	68.00	
];
elseif fs == 48000
    TABLE = [1	93.75	.925	24.17	
2	187.50	1.842	13.87	
3	281.25	2.742	10.01	
4	375.00	3.618	7.94	
5	468.75	4.463	6.62	
6	562.50	5.272	5.70	
7	656.25	6.041	5.00	
8	750.00	6.770	4.45	
9	843.75	7.457	4.00	
10	937.50	8.103	3.61	
11	1031.25	8.708	3.26	
12	1125.00	9.275	2.93	
13	1218.75	9.805	2.63	
14	1312.50	10.301	2.32	
15	1406.25	10.765	2.02	
16	1500.00	11.199	1.71	
17	1593.75	11.606	1.38	
18	1687.50	11.988	1.04	
19	1781.25	12.347	.67	
20	1875.00	12.684	.29	
21	1968.75	13.002	-.11	
22	2062.50	13.302	-.54	
23	2156.25	13.586	-.97	
24	2250.00	13.855	-1.43	
25	2343.75	14.111	-1.88	
26	2437.50	14.354	-2.34	
27	2531.25	14.585	-2.79	
28	2625.00	14.807	-3.22	
29	2718.75	15.018	-3.62	
30	2812.50	15.221	-3.98	
31	2906.25	15.415	-4.30	
32	3000.00	15.602	-4.57	
33	3093.75	15.783	-4.77	
34	3187.50	15.956	-4.91	
35	3281.25	16.124	-4.98	
36	3375.00	16.287	-4.97	
37	3468.75	16.445	-4.90	
38	3562.50	16.598	-4.76	
39	3656.25	16.746	-4.55	
40	3750.00	16.891	-4.29	
41	3843.75	17.032	-3.99	
42	3937.50	17.169	-3.64	
43	4031.25	17.303	-3.26	
44	4125.00	17.434	-2.86	
45	4218.75	17.563	-2.45	
46	4312.50	17.688	-2.04	
47	4406.25	17.811	-1.63	
48	4500.00	17.932	-1.24	
49	4687.50	18.166	-.51	
50	4875.00	18.392	.12	
51	5062.50	18.611	.64	
52	5250.00	18.823	1.06	
53	5437.50	19.028	1.39	
54	5625.00	19.226	1.66	
55	5812.50	19.419	1.88	
56	6000.00	19.606	2.08	
57	6187.50	19.788	2.27	
58	6375.00	19.964	2.46	
59	6562.50	20.135	2.65	
60	6750.00	20.300	2.86	
61	6937.50	20.461	3.09	
62	7125.00	20.616	3.33	
63	7312.50	20.766	3.60	
64	7500.00	20.912	3.89	
65	7687.50	21.052	4.20	
66	7875.00	21.188	4.54	
67	8062.50	21.318	4.91	
68	8250.00	21.445	5.31	
69	8437.50	21.567	5.73	
70	8625.00	21.684	6.18	
71	8812.50	21.797	6.67	
72	9000.00	21.906	7.19	
73	9375.00	22.113	8.33	
74	9750.00	22.304	9.63	
75	10125.00	22.482	11.08	
76	10500.00	22.646	12.71	
77	10875.00	22.799	14.53	
78	11250.00	22.941	16.54	
79	11625.00	23.072	18.77	
80	12000.00	23.195	21.23	
81	12375.00	23.309	23.94	
82	12750.00	23.415	26.90	
83	13125.00	23.515	30.14	
84	13500.00	23.607	33.67	
85	13875.00	23.694	37.51	
86	14250.00	23.775	41.67	
87	14625.00	23.852	46.17	
88	15000.00	23.923	51.04	
89	15375.00	23.991	56.29	
90	15750.00	24.054	61.94	
91	16125.00	24.114	68.00	
92	16500.00	24.171	68.00	
93	16875.00	24.224	68.00	
94	17250.00	24.275	68.00	
95	17625.00	24.322	68.00	
96	18000.00	24.368	68.00	
97	18375.00	24.411	68.00	
98	18750.00	24.452	68.00	
99	19125.00	24.491	68.00	
100	19500.00	24.528	68.00	
101	19875.00	24.564	68.00	
102	20250.00	24.597	68.00	
];
else
    disp('invalid sampling frequnecy');
    
end
% need to convert frequency to which fft slot
TABLE(:,1) = round(TABLE(:,2)/fs*512);

% map of nth fft sample to critical band number
CB_map = zeros(512/2,1);
for i = 1:length(TABLE(:,1))
    CB_map(TABLE(i,1):end) = CB_map(TABLE(i,1):end) +1;
end
if(bitrate>=96000)
    TABLE(:,4) = TABLE(:,4)-12;
end

AT = TABLE(:,4);
end